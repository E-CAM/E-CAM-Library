.. _ops_path_density:

#################################
Path Density for OpenPathSampling
#################################

.. sidebar:: Software Technical Information

  The information in this section describes OpenPathSampling as a whole.
  Information specific to the additions in this module are in subsequent
  sections.

  Language
    Python (2.7)

  Documentation Tool
    Sphinx, numpydoc format (ReST)

  Application Documentation
    http://openpathsampling.org

  Relevant Training Material
    http://openpathsampling.org/latest/examples/

  Licence
    LGPL, v. 2.1 or later

.. contents:: :local:

Authors: David W.H. Swenson

This module implements path density calculations for OpenPathSampling,
including a generic multidimensional sparse histogram, and plotting
functions for the two-dimensional case.

Purpose of Module
_________________

.. Give a brief overview of why the module is/was being created.

Path density is one of the useful ways to visualize a path ensemble
generated by path sampling. At first glance, a typical path density plot
may appear similar to a two-dimensional free energy landscape plot.
They are both "heatmap"-type plots, plotting a two-dimensional histogram in
some pair of collective variables. However, path density differs from free
energy in several important respects:

* A path density plot is histogrammed according to the number of paths, not
  the number of configurations. So if a cell is visited more than once
  during a path, it still only gets counted once.
* A path density plot may interpolate across cells that the path jumps
  over. This is because it is assumed that the input must actually be
  continuous.

These differences can prevent metastable regions from overwhelming the
transition regions in the plot. When looking at mechanisms, the path density
is a more useful tool than the raw configurational probability.

The implementation in this module includes:

* A ``SparseHistogram`` class for histogramming in arbitrary dimensions
  (allowing path densities in more than the traditional two dimensional
  plot). This class can also be used for other purposes (such as free energy
  histograms).
* A ``PathHistogram`` subclass of ``SparseHistogram``, which includes the
  options to normalize either per-path or per-configuration, and the tools
  for interpolating across skipped cells.
* A ``PathDensityHistogram`` subclass of ``PathHistogram``, which includes
  the ability to convert trajectories to representations of the trajectories
  in some list of collective variables, and sets reasonable default behavior
  for normalization and interpolation.
* A ``HistogramPlotter2D`` that is specialized for plotting a 2D histogram,
  especially a ``PathDensityHistogram``.


.. references would be nice here...

Background Information
______________________

This module builds on OpenPathSampling, a Python package for path sampling
simulations. To learn more about OpenPathSampling, you might be interested in
reading:

* OPS documentation: http://openpathsampling.org
* OPS source code: http://github.com/openpathsampling/openpathsampling


Testing
_______

Tests in OpenPathSampling use the `nose`_ package.

.. IF YOUR MODULE IS IN OPS CORE:

This module has been included in the OpenPathSampling core. Its tests can be
run by setting up a developer install of OpenPathSampling and running the
command ``nosetests`` from the root directory of the repository.

.. IF YOUR MODULE IS IN A SEPARATE REPOSITORY

.. The tests for this module can be run by downloading its source code, 
.. installing its requirements, and running the command ``nosetests`` from the
.. root directory of the repository.

Examples
________

The examples below link to both a notebook (in the OpenPathSampling GitHub
repository) and that same notebook in the context of the OpenPathSampling
official documentation. Note that these examples represent the most recent
version of code, and may not be identical to what was included in the
module. The original examples are included in the source code, below.

* Options for ``PathHistogram`` 
  [`PathHistogram on GitHub <https://github.com/openpathsampling/openpathsampling/blob/master/examples/misc/tutorial_path_histogram.ipynb>`_ 
  | `PathHistogram Docs <http://openpathsampling.org/latest/examples/miscellaneous/tutorial_path_histogram.html>`_]
* Use of ``PathDensityHistogram`` within analysis of alanine dipeptide TPS:
  [`PathDensityHistogram on Github
  <https://github.com/openpathsampling/openpathsampling/blob/master/examples/alanine_dipeptide_tps/AD_tps_3a_analysis_flex.ipynb>`_
  | `PathDensityHistogram Docs <http://openpathsampling.org/latest/examples/AD_tps.html>`_]


Source Code
___________

.. link the source code

.. IF YOUR MODULE IS IN OPS CORE

This module has been merged into OpenPathSampling. It is composed of the
following pull requests:

* https://github.com/openpathsampling/openpathsampling/pull/504
* https://github.com/openpathsampling/openpathsampling/pull/506
* https://github.com/openpathsampling/openpathsampling/pull/511

.. IF YOUR MODULE IS A SEPARATE REPOSITORY

.. The source code for this module can be found in: URL.

.. CLOSING MATERIAL -------------------------------------------------------

.. Here are the URL references used

.. _nose: http://nose.readthedocs.io/en/latest/

